<!DOCTYPE html>
<html lang="sk">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>rsvp</title>
    <link rel="stylesheet" href="./assets/style.css" />
    <script defer src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="https://cdn.jsdelivr.net/npm/js-confetti@latest/dist/js-confetti.browser.js"></script>
    <script
      defer
      src="https://cdnjs.cloudflare.com/ajax/libs/alpinejs/3.12.0/cdn.js"
    ></script>
  </head>
  <body>
    <section class="intro">
      <div class="info">
        <h1 class="title">Bude svadba.</h1>
        <div class="text">
          <p>S rados콘ou V치m oznamujeme, <br />쬰 chv칤쬿 doma zostaneme.</p>
          <p class="names">LUCIA & 컇UBO</p>
          <p>T칳mto V치s poz칳vame dohliadnu콘 na na코e "치no".</p>
          <p>
            Sobota 21. okt칩bra 2023 o 13:00 <br />
            <a
              href="https://www.google.com/maps/place/Budova+b%C3%BDvalej+Konskej+%C5%BEeleznice/@48.1559911,17.1223497,17z/data=!3m1!4b1!4m6!3m5!1s0x476c894bbd6301a3:0xe7c1faa1a14e0069!8m2!3d48.1559876!4d17.1249246!16s%2Fg%2F11cs9mfs46?entry=ttu"
              >Budova b칳valej Konskej 쬰leznice, Bratislava</a
            >
          </p>
          <p>
            Pol ry쬬, pol hranolky sa bud칰 serv칤rova콘 v
            <br />
            <a
              href="https://www.google.com/maps/place/BISTRIC+Restaurant/@48.2356897,17.0320762,17z/data=!3m1!4b1!4m6!3m5!1s0x476c8da21300f021:0x1204cd81d851f625!8m2!3d48.2356862!4d17.0369471!16s%2Fg%2F11ss6byfkw?entry=ttu"
              >Bistric Restaurant, Z치horsk치 Bystrica</a
            >
          </p>
          <p>Parkovanie mo쬹칠 priamo pred 콯eleznicou aj re코taur치ciou.</p>
          <p>
            Pros칤me o potvrdenie 칰캜asti<br />
            vyplnen칤m formul치ru ni쮄멸e.
          </p>
        </div>
      </div>
    </section>

    <section>
      <div class="form-container">
        <h1 class="form-title">RSVP</h1>
        <form x-data="rsvpForm()" @submit.prevent="submitForm">
          <label for="notAsearch">Meno</label>
          <input
            id="notAsearch"
            name="notAsearch"
            type="text"
            placeholder="Va코e meno"
            autocomplete="off"
            x-model="formData.name"
            required
          />

          <label for="answer">Kam sa chyst치m</label>
          <div id="answer" class="radio-group">
            <div>
              <input
                id="obrad"
                type="radio"
                value="obrad"
                x-model="formData.answer"
              />
              <label for="obrad">Pr칤dem iba na obrad</label>
            </div>
            <div>
              <input
                id="obed"
                type="radio"
                value="obed"
                x-model="formData.answer"
              />
              <label for="obed">Pr칤dem na obrad aj obed</label>
            </div>
            <div>
              <input
                id="nie"
                type="radio"
                value="nie"
                x-model="formData.answer"
              />
              <label for="nie">Nem칪쬰m sa dostavi콘</label>
            </div>
          </div>

          <label for="count">Po캜et host칤 (vr치tane V치s)</label>
          <input
            id="count"
            type="text"
            placeholder="Ko쬶o v치s pr칤de?"
            x-model="formData.count"
          />

          <label for="guests">Men치 캞al코칤ch host칤</label>
          <input
            id="guests"
            type="text"
            placeholder="Janko, Marienka..."
            x-model="formData.guests"
          />

          <label for="comment">Pozn치mka</label>
          <textarea
            id="comment"
            name="comment"
            placeholder="napr. potravinov칠 alergie"
            cols="30"
            rows="8"
            x-model="formData.comment"
          ></textarea>
          <p class="ps">
            Na z치ver dve mal칠 prosby:<br />
            1. kvety nechajte r치s콘 v z치hrad치ch<br />
            2. netr치pte sa s dar캜ekmi <br />
            T칳m najlep코칤m darom pre n치s bude, ke캞 pr칤dete. Ak v코ak ve쬸i ve쬸i
            ve쬸i chcete, pr칤spevok na svadobn칰 cestu ur캜ite nevyjde nazmar. Ve캞
            n치s pozn치te.
          </p>

          <button
            type="submit"
            :disabled="isLoading"
            x-text="isLoading ? 'Odosielam...' : 'Odosla콘'"
          ></button>
        </form>
      </div>
    </section>

    <script>
      //pockethost: https://rsvp.pockethost.io/api/collections/rsvp/records
      console.log(
        "%cVypl켿 formul치r a ne캜muchaj tu!游때游땢",
        "color: teal; font-family:monospace; font-size: 20px"
      );

      const jsConfetti = new JSConfetti();

      function rsvpForm() {
        return {
          formData: {
            name: "",
            answer: "obed",
            count: "",
            guests: "",
            comment: "",
          },
          isLoading: false,
          async submitForm() {
            this.isLoading = true;
            try {
              fetch(`https://wedd-rsvp.fly.dev/api/collections/rsvp/records`, {
                method: "POST",
                headers: {
                  "Content-Type": "application/json",
                },
                body: JSON.stringify(this.formData),
              })
                .then((res) => {
                  if (!res.ok) {
                    Swal.fire("游땮...sk칰s znovu");
                    this.isLoading = false;
                    this.resetForm();
                    throw new Error(res.status);
                  }
                  return res.json();
                })
                .then((data) => {
                  if (data.message) {
                    Swal.fire(data.message);
                  } else {
                    jsConfetti.addConfetti();
                  }
                  this.isLoading = false;
                  this.resetForm();
                });
            } catch (error) {
              console.log(error);
            }
          },
          resetForm() {
            this.formData.name = "";
            this.formData.answer = "obed";
            this.formData.count = "";
            this.formData.guests = "";
            this.formData.comment = "";
          },
        };
      }
    </script>
  </body>
</html>
